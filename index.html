<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web OS - Windows 7</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
    <style>
        /* Обновлённые стили */
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: "Segoe UI", Arial, sans-serif;
        }

        .desktop {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: url('win.png') no-repeat center center fixed;
            background-size: cover;
        }

        /* Стили для меню Start */
        .start-menu {
            position: absolute;
            bottom: 40px;
            left: 0;
            width: 300px;
            height: 400px;
            background: linear-gradient(to bottom, #4a6a9b, #2a3f5f);
            border: 1px solid #1a2f4f;
            display: none;
            z-index: 1000;
        }

        /* Стили для календаря */
        .calendar {
            position: absolute;
            bottom: 40px;
            right: 0;
            width: 250px;
            background: white;
            border: 1px solid #ccc;
            padding: 10px;
            display: none;
            z-index: 1000;
        }

        /* Остальные стили остаются с предыдущей версии, добавляем новые */
        .window-control:hover {
            background-color: rgba(255,255,255,0.3) !important;
        }
    </style>
</head>
<body>
    <div class="desktop">
        <div class="desktop-icon" style="left: 20px; top: 20px;">
            <img src="computer.png" alt="Computer" width="48">
            <div>Computer</div>
        </div>

        <div class="window" style="width: 400px; height: 300px; left: 100px; top: 100px;">
            <div class="window-header">
                <span>My Computer</span>
                <div class="window-controls">
                    <button class="window-control minimize" style="background: #4caf50"></button>
                    <button class="window-control maximize" style="background: #fdd835"></button>
                    <button class="window-control close" style="background: #f44336"></button>
                </div>
            </div>
            <div class="window-content">
                <!-- Content here -->
            </div>
        </div>

        <div class="taskbar">
            <button class="start-button" id="startButton">
                <img src="windows-icon.png" alt="Start" width="16">
                Start
            </button>
            <div class="clock" id="clock"></div>
        </div>

        <!-- Новые элементы -->
        <div class="start-menu" id="startMenu">
            <div class="menu-section">
                <div class="menu-item shutdown">Завершение работы</div>
            </div>
        </div>

        <div class="calendar" id="calendar">
            <div id="calendarContent"></div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script>
        $(function() {
            // Инициализация перетаскивания окон
            $(".window").draggable({
                handle: ".window-header",
                containment: "parent"
            });

            // Инициализация перетаскивания иконок
            $(".desktop-icon").draggable({
                containment: "parent",
                stack: ".desktop-icon"
            });

            // Обновление времени
            function updateClock() {
                const now = new Date();
                $('#clock').text(now.toLocaleString());
            }
            setInterval(updateClock, 1000);
            updateClock();

            // Управление окнами
            $('.window-control.close').click(function() {
                $(this).closest('.window').hide();
            });

            $('.window-control.minimize').click(function() {
                $(this).closest('.window').animate({
                    top: '100vh'
                }, 300);
            });

            $('.window-control.maximize').click(function() {
                const window = $(this).closest('.window');
                window.toggleClass('maximized');
                if(window.hasClass('maximized')) {
                    window.css({width: '100vw', height: 'calc(100vh - 40px)', top: 0, left: 0});
                } else {
                    window.css({width: '400px', height: '300px', top: '100px', left: '100px'});
                }
            });

            // Календарь
            $('#clock').click(function(e) {
                e.stopPropagation();
                const now = new Date();
                const calendarHTML = `
                    <div class="calendar-header">
                        ${now.toLocaleString('default', { month: 'long', year: 'numeric' })}
                    </div>
                    <div class="calendar-dates">
                        ${generateCalendar(now)}
                    </div>
                `;
                $('#calendarContent').html(calendarHTML);
                $('#calendar').toggle().css({
                    bottom: '40px',
                    right: '0'
                });
            });

            function generateCalendar(date) {
                // Генерация календаря
                const daysInMonth = new Date(date.getFullYear(), date.getMonth()+1, 0).getDate();
                let html = '';
                for(let i = 1; i <= daysInMonth; i++) {
                    html += `<div class="calendar-day ${i === date.getDate() ? 'today' : ''}">${i}</div>`;
                }
                return html;
            }

            // Меню Start
            $('#startButton').click(function(e) {
                e.stopPropagation();
                $('#startMenu').toggle();
            });

            $('.shutdown').click(function() {
                window.close();
            });

            // Закрытие меню при клике вне его
            $(document).click(function() {
                $('#startMenu').hide();
                $('#calendar').hide();
            });

            // Предотвращение закрытия при клике внутри меню
            $('#startMenu, #calendar').click(function(e) {
                e.stopPropagation();
            });
        });
    </script>
</body>
</html>
